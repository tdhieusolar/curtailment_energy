# Inverter Control System - PhiÃªn báº£n 0.5.2

## ğŸ“‹ Giá»›i thiá»‡u

Há»‡ thá»‘ng Ä‘iá»u khiá»ƒn inverter tá»± Ä‘á»™ng vá»›i kháº£ nÄƒng Ä‘á»c cáº¥u hÃ¬nh tá»« file Excel, quáº£n lÃ½ driver thÃ´ng minh sá»­ dá»¥ng Semaphore vÃ  há»— trá»£ Báº­t/táº¯t 1 INV xÃ¡c Ä‘á»‹nh.

## ğŸ†• TÃ­nh nÄƒng má»›i trong v0.5.2

### ğŸ”Œ Báº­t/táº¯t 1 INV xÃ¡c Ä‘á»‹nh
- **Äiá»u khiá»ƒn chÃ­nh xÃ¡c**: Báº­t/táº¯t tá»«ng inverter riÃªng láº»
- **Äá»‹nh dáº¡ng Ä‘Æ¡n giáº£n**: `[Station-Inverter] [ON/OFF]`
- **VÃ­ dá»¥**: `B3R1-INV-01 ON`, `B4R2-INV-05 OFF`
- **Auto-complete**: Tá»± Ä‘á»™ng tÃ¬m station vÃ  inverter
- **XÃ¡c nháº­n an toÃ n**: Hiá»ƒn thá»‹ thÃ´ng tin chi tiáº¿t trÆ°á»›c khi thá»±c hiá»‡n

### ğŸ” TÃ¬m kiáº¿m inverter
- **TÃ¬m kiáº¿m thÃ´ng minh**: Theo tÃªn inverter, station, URL, info
- **VÃ­ dá»¥**: `INV-01`, `B3R1`, `121`, ...
- **Káº¿t quáº£ chi tiáº¿t**: Hiá»ƒn thá»‹ Ä‘áº§y Ä‘á»§ thÃ´ng tin inverter

### ğŸ¯ Menu má»›i
ğŸ“‹ MENU CHÃNH:

Táº¯t má»™t sá»‘ inverter

Báº­t má»™t sá»‘ inverter

Báº­t táº¥t cáº£ inverter

Báº­t/táº¯t 1 inverter â† Má»šI: Äiá»u khiá»ƒn riÃªng láº»

TÃ¹y chá»‰nh

Xem tráº¡ng thÃ¡i há»‡ thá»‘ng

Quáº£n lÃ½ cáº¥u hÃ¬nh Excel

ThoÃ¡t chÆ°Æ¡ng trÃ¬nh

text

### ğŸ“Š Há»‡ thá»‘ng tráº¡ng thÃ¡i má»Ÿ rá»™ng
- **TÃ¬m kiáº¿m inverter**: Menu tÃ¬m kiáº¿m thÃ´ng minh
- **Danh sÃ¡ch chi tiáº¿t**: Hiá»ƒn thá»‹ táº¥t cáº£ inverters vá»›i Ä‘áº§y Ä‘á»§ thÃ´ng tin
- **Thá»‘ng kÃª nÃ¢ng cao**: PhÃ¢n tÃ­ch tráº¡ng thÃ¡i há»‡ thá»‘ng

## ğŸš€ TÃ­nh nÄƒng chÃ­nh

- âœ… **Excel Configuration**: Äá»c cáº¥u hÃ¬nh tá»« file Excel
- âš¡ **Semaphore-based Driver Pool**: Quáº£n lÃ½ driver thÃ´ng minh khÃ´ng dÃ¹ng sleep
- ğŸ”Œ **Báº­t/táº¯t 1 INV**: Äiá»u khiá»ƒn chÃ­nh xÃ¡c tá»«ng inverter
- ğŸ” **TÃ¬m kiáº¿m thÃ´ng minh**: TÃ¬m inverter theo nhiá»u tiÃªu chÃ­
- ğŸ”Œ **Báº­t táº¥t cáº£ INV**: Há»— trá»£ toÃ n bá»™ há»‡ thá»‘ng
- ğŸ“Š **Interactive Menu**: Menu tÆ°Æ¡ng tÃ¡c vá»›i tÃ­nh nÄƒng Quay láº¡i
- ğŸ”„ **Smart Retry Mechanism**: Xá»­ lÃ½ thÃ´ng minh vá»›i cÆ¡ cháº¿ retry

## ğŸ”§ CÃ¡ch sá»­ dá»¥ng Báº­t/táº¯t 1 INV

### 1. Sá»­ dá»¥ng Menu chÃ­nh
Chá»n menu: 4
Äá»‹nh dáº¡ng: [Station-Inverter] [ON/OFF]
VÃ­ dá»¥: B3R1-INV-01 ON
VÃ­ dá»¥: B4R2-INV-05 OFF

text

### 2. Lá»‡nh Ä‘áº·c biá»‡t trong menu
- `list` - Xem danh sÃ¡ch táº¥t cáº£ inverters
- `back` - Quay láº¡i menu chÃ­nh

### 3. TÃ¬m kiáº¿m inverter
Chá»n menu: 6 (Xem tráº¡ng thÃ¡i há»‡ thá»‘ng)
Chá»n: 5 (TÃ¬m kiáº¿m inverter)
Nháº­p tá»« khÃ³a: INV-01, B3R1, 121, ...

text

## ğŸ“Š Thá»‘ng kÃª há»‡ thá»‘ng

**Tá»•ng sá»‘ inverter**: 143 inverter  
**Tá»•ng sá»‘ stations**: 14 stations  
**Zones**: 1 zone (Zone B)

### VÃ­ dá»¥ Ä‘iá»u khiá»ƒn:
- `B3R1-INV-01 ON` - Báº­t inverter Ä‘áº§u tiÃªn cá»§a station B3R1
- `B4R2-INV-05 OFF` - Táº¯t inverter thá»© 5 cá»§a station B4R2  
- `B8-INV-03 ON` - Báº­t inverter thá»© 3 cá»§a station B8

## ğŸ—ï¸ Cáº¥u trÃºc dá»± Ã¡n
inverter_control/
â”œâ”€â”€ ğŸ“ config/ # Cáº¥u hÃ¬nh há»‡ thá»‘ng
â”‚ â”œâ”€â”€ init.py
â”‚ â”œâ”€â”€ excel_reader.py # Äá»c cáº¥u hÃ¬nh tá»« Excel
â”‚ â”œâ”€â”€ selectors.py # CSS Selectors cho web elements
â”‚ â”œâ”€â”€ settings.py # Cáº¥u hÃ¬nh chung (v0.5.2)
â”‚ â””â”€â”€ system_config.py # Cáº¥u hÃ¬nh há»‡ thá»‘ng máº·c Ä‘á»‹nh
â”œâ”€â”€ ğŸ“ core/ # Core components
â”‚ â”œâ”€â”€ init.py
â”‚ â”œâ”€â”€ controller.py # Äiá»u khiá»ƒn inverter (v0.5.2 tá»‘i Æ°u)
â”‚ â”œâ”€â”€ driver_pool.py # Quáº£n lÃ½ driver pool (v0.5.2 - Semaphore)
â”‚ â”œâ”€â”€ logger.py # Há»‡ thá»‘ng logging
â”‚ â””â”€â”€ task_queue.py # HÃ ng Ä‘á»£i thÃ´ng minh
â”œâ”€â”€ ğŸ“ processors/ # Xá»­ lÃ½ tÃ¡c vá»¥
â”‚ â”œâ”€â”€ init.py
â”‚ â””â”€â”€ task_processor.py # Xá»­ lÃ½ task vá»›i rate limiting (v0.5.2)
â”œâ”€â”€ ğŸ“ utils/ # Tiá»‡n Ã­ch
â”‚ â”œâ”€â”€ init.py
â”‚ â””â”€â”€ helpers.py # HÃ m utility há»— trá»£
â”œâ”€â”€ ğŸ“„ main.py # Entry point chÃ­nh
â”œâ”€â”€ ğŸ“Š inverter_config.xlsx # File cáº¥u hÃ¬nh Excel
â””â”€â”€ ğŸ“‹ requirements.txt # ThÆ° viá»‡n dependencies

text

## ğŸ“Š Cáº¥u trÃºc dá»¯ liá»‡u

### File Excel Configuration

#### Sheet "Stations"
| Cá»™t | MÃ´ táº£ | VÃ­ dá»¥ |
|-----|-------|-------|
| Zone | VÃ¹ng/khu vá»±c | Zone B |
| Station | Tráº¡m inverter | B3R1 |
| Inverter | TÃªn inverter | INV-01 |
| URL | Äá»‹a chá»‰ IP | 10.10.10.121 |
| Status | Tráº¡ng thÃ¡i | OK |
| Info | ThÃ´ng tin mÃ´ táº£ | Inverter sá»‘ 1 |

#### Sheet "Control_Scenarios"
| Cá»™t | MÃ´ táº£ | VÃ­ dá»¥ |
|-----|-------|-------|
| Station | Tráº¡m cáº§n Ä‘iá»u khiá»ƒn | B3R1 |
| Action | HÃ nh Ä‘á»™ng (ON/OFF) | OFF |
| Count | Sá»‘ lÆ°á»£ng inverter | 4 |

# Inverter Control System - PhiÃªn báº£n 0.5.3

## ğŸ“‹ Giá»›i thiá»‡u

Há»‡ thá»‘ng Ä‘iá»u khiá»ƒn inverter tá»± Ä‘á»™ng vá»›i driver pool Ä‘Æ°á»£c tá»‘i Æ°u cho cáº£ trÆ°á»ng há»£p Ã­t tasks vÃ  nhiá»u tasks.

## ğŸ†• Tá»‘i Æ°u hÃ³a trong v0.5.3

### ğŸ¯ Driver Pool ThÃ´ng minh
- **1 task = 1 driver**: Khi chá»‰ cÃ³ 1 task, chá»‰ khá»Ÿi táº¡o 1 driver
- **2-3 tasks = 2 drivers**: Tá»‘i Æ°u cho sá»‘ lÆ°á»£ng tasks nhá»
- **Nhiá»u tasks = TÃ­nh toÃ¡n tá»‘i Æ°u**: Sá»­ dá»¥ng cÃ´ng thá»©c thÃ´ng minh cho nhiá»u tasks

### âš¡ Chiáº¿n lÆ°á»£c xá»­ lÃ½ Ä‘a dáº¡ng
- **Single Task Mode**: Xá»­ lÃ½ tuáº§n tá»± cho 1 task
- **Few Tasks Mode**: Xá»­ lÃ½ song song Ä‘Æ¡n giáº£n cho 2-3 tasks  
- **Many Tasks Mode**: Xá»­ lÃ½ song song vá»›i batch cho nhiá»u tasks

### ğŸ“Š Cáº¥u hÃ¬nh tá»‘i Æ°u
```python
CONFIG = {
    "driver": {
        "max_pool_size": 8,
        "min_pool_size": 1,  # QUAN TRá»ŒNG: Giáº£m tá»« 3 xuá»‘ng 1
    }
}
ğŸ¯ Logic tÃ­nh toÃ¡n Pool Size má»›i
TrÆ°á»ng há»£p 1 task:
text
1 task â†’ 1 driver
TrÆ°á»ng há»£p 2-3 tasks:
text
2 tasks â†’ 2 drivers
3 tasks â†’ 2 drivers (tá»‘i Ä‘a)
TrÆ°á»ng há»£p nhiá»u tasks:
text
tasks â‰¤ 3: min(2, tasks)
tasks > 3: min(max_pool_size, max(min_pool_size, ceil(tasks / tasks_per_driver)))
ğŸ“ˆ Hiá»‡u suáº¥t cáº£i thiá»‡n
TrÆ°á»›c Ä‘Ã¢y (v0.5.2):
1 task â†’ 3 drivers (lÃ£ng phÃ­)

2 tasks â†’ 3 drivers (lÃ£ng phÃ­)

3 tasks â†’ 3 drivers

Hiá»‡n táº¡i (v0.5.3):
1 task â†’ 1 driver (tá»‘i Æ°u)

2 tasks â†’ 2 drivers (tá»‘i Æ°u)

3 tasks â†’ 2 drivers (tá»‘i Æ°u)

10 tasks â†’ 3 drivers (tÃ­nh toÃ¡n thÃ´ng minh)

ğŸ—ï¸ Cáº¥u trÃºc xá»­ lÃ½ má»›i
text
run_parallel_optimized()
â”œâ”€â”€ 1 task â†’ _process_single_task() [TUáº¦N Tá»°]
â”œâ”€â”€ 2-3 tasks â†’ _process_few_tasks() [SONG SONG ÄÆ N GIáº¢N]  
â””â”€â”€ >3 tasks â†’ _process_many_tasks() [SONG SONG BATCH]
ğŸ”§ CÃ¡c cáº£i tiáº¿n ká»¹ thuáº­t
1. DynamicDriverPool
Logic tÃ­nh toÃ¡n pool size thÃ´ng minh

Äáº£m báº£o khÃ´ng táº¡o driver thá»«a

Tá»‘i Æ°u resource usage

2. TaskProcessor
Chiáº¿n lÆ°á»£c xá»­ lÃ½ Ä‘a dáº¡ng theo sá»‘ lÆ°á»£ng tasks

Retry handling Ä‘Æ°á»£c tá»‘i Æ°u

Progress reporting chi tiáº¿t

3. Configuration
min_pool_size = 1 thay vÃ¬ 3

CÃ¢n báº±ng giá»¯a performance vÃ  resource

ğŸ“Š Káº¿t quáº£ thá»±c táº¿
Xá»­ lÃ½ 1 inverter:
Thá»i gian: ~10-15 giÃ¢y

Memory usage: Giáº£m 60%

Driver usage: 1 driver thay vÃ¬ 3

Xá»­ lÃ½ Báº­t táº¥t cáº£ (143 inverters):
Thá»i gian: ~15-20 phÃºt

Driver usage: 8 drivers (khÃ´ng Ä‘á»•i)

Stability: TÄƒng Ä‘á»™ á»•n Ä‘á»‹nh

Developer: Inverter Control Team
Version: 0.5.3 - Optimized Pool
Optimization: 1 task = 1 driver
Performance: Tá»‘i Æ°u resource usage

text

## ğŸ¯ TÃ³m táº¯t cáº£i tiáº¿n

### 1. **Logic tÃ­nh toÃ¡n Pool Size thÃ´ng minh**
- âœ… **1 task = 1 driver** (thay vÃ¬ 3)
- âœ… **2-3 tasks = 2 drivers** (tá»‘i Æ°u)
- âœ… **Nhiá»u tasks = TÃ­nh toÃ¡n thÃ´ng minh**

### 2. **Chiáº¿n lÆ°á»£c xá»­ lÃ½ Ä‘a dáº¡ng**
- âœ… **Single Task Mode**: Tuáº§n tá»± cho 1 task
- âœ… **Few Tasks Mode**: Song song Ä‘Æ¡n giáº£n
- âœ… **Many Tasks Mode**: Song song batch

### 3. **Cáº¥u hÃ¬nh tá»‘i Æ°u**
- âœ… **min_pool_size = 1** (giáº£m tá»« 3)
- âœ… **CÃ¢n báº±ng performance/resource**
- âœ… **KhÃ´ng lÃ£ng phÃ­ tÃ i nguyÃªn**

### 4. **Káº¿t quáº£**
- âœ… **Giáº£m memory usage** 60% cho 1 task
- âœ… **TÄƒng tá»‘c Ä‘á»™** xá»­ lÃ½ task Ä‘Æ¡n láº»
- âœ… **Tá»‘i Æ°u resource** cho má»i scenario

Sau khi cáº­p nháº­t, chÆ°Æ¡ng trÃ¬nh sáº½:
- âœ… **Chá»‰ dÃ¹ng 1 driver** khi xá»­ lÃ½ 1 inverter
- âœ… **Tá»‘i Æ°u sá»‘ driver** cho 2-3 inverters  
- âœ… **KhÃ´ng lÃ£ng phÃ­** tÃ i nguyÃªn há»‡ thá»‘ng
- âœ… **Performance tá»‘t hÆ¡n** cho má»i trÆ°á»ng há»£p